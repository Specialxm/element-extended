on:
  # 📦 监听 push 操作
  push:
    branches:
      - main # ✅ 只监听 main 分支

permissions:
  contents: write # ✍️ 允许写入 gh-pages 分支

jobs:
  # 🛠️ 定义构建任务
  build:
    runs-on: ubuntu-latest # 💻 使用最新版 Ubuntu 环境
    steps:
      - name: 📥 检出代码
        uses: actions/checkout@v4

      - name: 🔧 设置 Node.js 环境
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: 🧩 安装 pnpm
        uses: pnpm/action-setup@v3
        with:
          version: 8 # ✅ 使用指定版本 pnpm（根据你的项目版本调整）

      - name: 📦 安装依赖并打包项目
        run: |
          pnpm i pnpm@latest -g # 确保使用最新 pnpm
          pnpm install
          pnpm run build:admin

      - name: 🚀 部署到 GitHub Pages
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          branch: gh-pages # 🌿 部署目标分支
          folder: apps/web-admin/dist # 📁 打包产物目录
